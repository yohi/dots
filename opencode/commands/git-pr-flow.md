---
description: 状況に応じてfeatureブランチ作成/選択、関連ファイルのコミット、PR作成（未存在時のみ）を行うスマートフロー
agent: sisyphus
model: google/antigravity-gemini-3-pro
---

あなたは熟練したソフトウェアエンジニアです。現在のリポジトリの状態（ブランチ、PRの有無）と変更内容を解析し、最適なGitワークフローを実行してください。

## ゴール
変更内容を適切なブランチにコミットし、リモートにプッシュすること。PRがまだない場合のみ新規作成すること。

## 制約事項
1. **言語**: コミットメッセージ、PRのタイトル・本文は「日本語」。
2. **形式**: [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) に準拠（例: `feat:`, `fix:`）。
3. **ステージング**: `git add .` は**厳禁**。変更内容を確認し、関連ファイルのみをパス指定で追加すること。
4. **PRテンプレート**: 新規作成時は必ず指定のテンプレートを使用すること。

## 実行フロー

### Step 0: 現状分析とプランニング
まず以下のコマンド等で現状を確認してください。
- `git branch --show-current`: 現在のブランチ名
- `gh pr list --head <current_branch>`: 現在のブランチに紐づくPRの有無（ghコマンドが使える場合）

**判断ロジック:**
- **ブランチ作成**: 現在が `main`, `master`, `develop` 等の主要ブランチの場合 → **新規作成** (`feature/...` 等)
- **ブランチ維持**: 現在がすでに `feature/...` や `fix/...` 等の作業ブランチの場合 → **そのまま使用**
- **PR作成**: 既存のPRがない場合 → **作成する**
- **PRスキップ**: 既存のPRがある場合 → **作成しない（コミットとPushのみで更新）**

### Step 1: ブランチの切り替え（必要な場合のみ）
Step 0の判断に基づき、必要であればブランチを作成・切り替えを行ってください。
- コマンド: `git checkout -b <branch_name>`

### Step 2: ステージングとコミット
`git-master` スキルを明示的に使用して、変更をコミットしてください。
以下の制約を `git-master` に適用してください：
- **言語**: 日本語を使用すること
- **スタイル**: Conventional Commits (例: `feat: ...`)
- **コミット粒度**: 変更内容に応じて適切に分割すること（Atomic Commits）

（注意: 自分で `git commit` コマンドを実行せず、git-master の自律機能に任せてください）

### Step 3: プッシュ
- コマンド: `git push origin HEAD`

### Step 4: PRの作成（必要な場合のみ）
Step 0で「PR作成が必要」と判断した場合のみ実行してください。既存PRがある場合は、更新された旨をユーザーに伝えて終了してください。

**PRテンプレート:**
```markdown
## 概要
<ここに変更の要約を記載（日本語）>

## 関連Issue
- fix #<issue番号があれば記載、なければ "なし">

## 変更内容
<変更点のリストを具体的に記載（日本語）>
- 例: バリデーションライブラリを `v1` から `v2` へアップデート
- <実際の変更点1>
- <実際の変更点2>

## 動作確認手順
1. <動作確認のための具体的な手順1>
2. <動作確認のための具体的な手順2>

## スクリーンショット（UI変更がある場合）
| Before | After |
| --- | --- |
| <img src="..." width="300" /> | <img src="..." width="300" /> |

## チェックリスト
- [ ] タイトルを [Conventional Commits](https://www.conventionalcommits.org/ja/v1.0.0/) に従ったものにした
- [ ] ローカルでテストが通ることを確認した
- [ ] ドキュメントを更新した（必要な場合）
```
